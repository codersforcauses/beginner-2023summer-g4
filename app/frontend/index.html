<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" type="text/css" href="/static/css/main.css">
    <link rel="stylesheet" type="text/css" href="/static/css/styles.css">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Lalezar&family=Roboto&display=swap" rel="stylesheet">
    
    <title>PerthPinpoint</title>
</head>
<body>
    <div class="landing-page">
        <header>
            <h1 class = 'landing-title heading' style = 'margin-top: 0; margin-bottom: 0;'><a href="/">PerthPinpoint</a></h1>
            <nav>
                <a href="/">Home</a>
                <a href="/tutorial">Tutorial</a>
                <a href="/leaderboard">Leaderboard</a>
            </nav>
        </header>

        <div class = 'login-container'>
            <div class='login-bar'>
                <div class='sub-heading heading'>Enter a username</div>
                <p class = 'game-desc'>To play PerthPinpoint, enter a username that you would like to play with. This username will appear on the leaderboard
                    if you get a top score.</p>
                <input type="text" id="username" name="username" required placeholder="Enter a Username...">
                <div style = 'display: none; color: #FF413D; line-height: 1.8;'class='username-rules' id = 'username-rules'>
                    <p>The username must contain only:</p>
                    <ul>
                        <li>Letters</li>
                        <li>Numbers</li>
                        <li>Spaces</li>
                        <li>Underscores (_)</li>
                        <li>Periods (.)</li>
                    </ul>
                </div>
            </div>
            <img class="landing-image" src ="/static/assets/perth-image.jpg">

            <script>
                if (localStorage.getItem("username")) {
                  document.getElementById("username").value = localStorage.getItem("username");
                }
                // document.querySelector("form").addEventListener("submit", function(event) {
                //   event.preventDefault(); 
                //   var username = document.getElementById("username").value;
                //   localStorage.setItem("username", username);
                // });
            </script>
        </div>


        <!-- Game mode options -->
        <div class= "game-modes-submit">
            <div class="game-modes">
                <div class="game-mode-title sub-heading heading" style = 'color: black; margin-bottom: 0;'>Select a Game Mode</div>
                    <p style = 'color: black; text-align: center; line-height: 1.8; margin-top: 0; margin-bottom: 15px;'>
                        Select a game mode to play.<br> Each game mode has a different objective and different rules.
                        Visit the <a href="/tutorial">tutorial page</a> to learn more about each game mode.
                    </p>
                <div class="game-mode-options">
                    <label class="game-mode-option">
                        <input type="radio" name="gameMode" value="city">
                        <img src="/static/assets/bell_tower.png" alt="Classic City Image">
                        <div class = 'game-card-info-text'>
                            <div class="game-mode-label heading">Classic City</div>
                            <p class = 'game-mode-card-description' style = ''>
                                The classic game mode. Find the location of the city you are playing in. 
                                The closer you are to the location, the more points you get.
                            </p>
                            <button class = 'game-submit' onclick= "enterMainPage('city')">Play Now</button>
                        </div>
                    </label>

                    <label class="game-mode-option">
                        <input type="radio" name="gameMode" value="sleuth">
                        <img src="/static/assets/kwinana-freeway-stock-image.webp" alt="Street Sleuth Image">
                        <div class = 'game-card-info-text'>
                            <div class="game-mode-label heading">Streeth Sleuth</div>
                            <p class = 'game-mode-card-description' style = ''>
                                Find the location of the street you are playing in. 
                                The closer you are to the location, the more points you get.
                            </p>
                            <button class = 'game-submit' onclick= "enterMainPage('sleuth')">Play Now</button>
                        </div>
                    </label>

                    <label class="game-mode-option">
                        <input type="radio" name="gameMode" value="landmark">
                        <img src="/static/assets/cactus.jpg" alt="Local Landmark Image">
                        <div class = 'game-card-info-text'>
                            <div class="game-mode-label heading">Local Landmark</div>
                            <p class = 'game-mode-card-description' style = ''>
                                Find the location of the landmark you are playing in. 
                                The closer you are to the location, the more points you get.
                            </p>
                            <button class = 'game-submit' onclick= "enterMainPage('landmark')">Play Now</button>
                        </div>
                    </label>
                </div>
            </div>
        </div>


    </div>
    
    <script>

        function notValidUsername() {
            document.querySelector(".login-bar input").style.border = "3px solid red";
            window.scrollTo({
                    top: 0,
                    behavior: 'smooth'
                });

            const usernameRules = document.getElementById('username-rules');
            if (usernameRules.style.display === 'none') {
                usernameRules.style.display = 'block'
            }

        }
        function enterMainPage(selectedMode) {
            const username = document.getElementById('username').value;
            const usernameRegex = new RegExp('^[a-zA-Z0-9._ ]+$', 'i');

            if (!usernameRegex.test(username)) {
                notValidUsername();
                return;
            }


            localStorage.setItem("game_mode", selectedMode);
            localStorage.setItem("username", username);

            if (selectedMode === "city") {
                window.location.href = "/city";
            }
            else if (selectedMode == "sleuth"){
                window.location.href = "/sleuth";
            }
            else if (selectedMode == "landmark"){
                window.location.href = "/landmark";
            }
            
        }
    </script>
</body>
</html>